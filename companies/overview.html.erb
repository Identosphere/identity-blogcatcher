<!DOCTYPE html>
<html>
  <head>
   <meta charset='utf-8'>
   <meta name='generator' content='<%= Pluto.generator %>'>
   <title>Identosphere Blogcatcher | Companies Feed</title>

  <%= stylesheet_link_tag 'css/et-book' %>
  <%= stylesheet_link_tag 'css/planetid.overview' %>
   
   <!-- fix: use script_tag  rails-style ??? -->
   <script src='js/jquery-2.0.3.min.js'></script>
   <script src='js/planetid.js'></script>
 
   <%# = javascript_include_tag 'js/jquery-2.0.3.min.js' %>
   <%# = javascript_include_tag 'js/planetid.js' %>

   <script data-goatcounter="https://identosphere.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
  </head>
  <body>
  <div class='banner'>
  <table cellspacing='0' cellpadding='0' width='100%'>
    <tr>
      <td>
      <!-- left/1st column -->
      <a href="https://identosphere.net">Identosphere</a> â€¢ <a href="https://github.com/identosphere/planetid-reboot/">on Github</a> | <a href="/blogcatcher/">Blog Catcher</a> |  <a href="/blogcatcher/orgsfeed/">Orgs Feed</a> |  <a href="/blogcatcher/companies/"><b>Companies</b></a> | 
      Last Update <%= site.updated.strftime('%-I:%M %p %B %d, %Y') %> (UTC)
      </td>
      <td style='text-align:right;'>
      <!-- right/2nd column -->
      Style | <%= link_to 'Full', "/blogcatcher/companies/" %> &bull; <%= link_to '<b>Overview</b>', "overview.html" %>
      </td>
    </tr>
  </table>
  </div>   

<h1>Identosphere Companies Feed - Latest Headlines</h1>
<!-- use a table w/ three colums -->

<table>
  <colgroup>
    <col width='33%'>
    <col width='33%'>
    <col width='33%'>
  </colgroup>
<tr>

<!-- check/fix: check if it will work w/o .all. - depreciated in rails 4+ -->
<%  site.feeds.latest.to_a.in_columns(3).each do |feeds| %>
<td valign='top'>
  <!-- start new column -->

  <% feeds.each do |feed| %>


<div class='feed'>
<h3><%= link_to feed.title, feed.url %></h3>
<table>
  <!-- todo:
     include latest 11 (more than 4 add hidden
       plus add a more toggle button to show all 11!! )
    -->
  <% feed.items.latest.limit(4).each do |item|
     
      ## todo: use markdownify in future version
      ## todo: unescape all &xx; entities -html and unicode - how?
      
      if item.summary
        item_snippet_plain_text = whitelist( item.summary, [] )[0..500]
      elsif item.content
        item_snippet_plain_text = whitelist( item.content, [] )[0..500]
      else
        item_snippet_plain_text = '-/-'
      end
      if item.title.blank?
        item.title = item_snippet_plain_text[0..60]
      end
  %>
    <tr>
     <td valign='top'>
      <span class='item-published'>
          <!-- fix/todo: show year if not current year
             e.g. use "%b %d, '%y"
          -->
        <%= item.published.strftime("%b %d") %>
      </span>
     </td>
     <td>
       <span class='item-title'>
           <%= link_to item.title, item.url, title: item_snippet_plain_text.strip %>
       </span>
       <span class='item-time-ago-in-words'><%= time_ago_in_words( item.published ) %></span>
     </td>
    </tr>
  <% end %><!-- each item -->
</table>
</div>


  <% end %><!-- each feed (inside column) -->
 </td>
<% end %><!-- each column-->
  </tr>
</table>

</body>
</html>
